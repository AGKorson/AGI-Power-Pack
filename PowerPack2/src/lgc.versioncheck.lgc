[ [ lgc.versioncheck[ [[ This logic uses takes advantage of AGI's failure to validate[ string numbers to determine what version of AGI is running.[ Because thedata in agidata.ovl varies between versions, by[ testing certain string values it is possible to know exactly[ which version is running[ ideally, these should be defined in the global list (or a [ defines.txt file, if you are not using the global defines[ feature)#define IntVersion        v30#define VERSION_UNKNOWN     0#define VERSION_2089        1#define VERSION_2272        2#define VERSION_2411        3#define VERSION_2425        4#define VERSION_2426        5#define VERSION_2435        6#define VERSION_2439        7#define VERSION_2440        8#define VERSION_2903        9#define VERSION_2911       10#define VERSION_2912       11#define VERSION_2915       12#define VERSION_2917       13#define VERSION_2936       14#define VERSION_3002086    15#define VERSION_3002098    16#define VERSION_3002102    17#define VERSION_3002107    18#define VERSION_3002149    19[ s29=" Durgan" means 2.089s1 = m1;if (compare.strings(s1, s29)) {  IntVersion = VERSION_2089;  goto(found);}[ s41="uit." means 2.272s1 = m2;if (compare.strings(s1, s41)) {  IntVersion = VERSION_2272;  goto(found);}[ s55="ersion 2.xxx" means 2.411 through 2.440s1 = m3;if (compare.strings(s1, s55)) {  IntVersion = VERSION_2411;  goto(found);}s1 = m4;if (compare.strings(s1, s55)) {  IntVersion = VERSION_2425;  goto(found);}s1 = m5;if (compare.strings(s1, s55)) {  IntVersion = VERSION_2426;  goto(found);}s1 = m6;if (compare.strings(s1, s55)) {  IntVersion = VERSION_2435;  goto(found);}s1 = m7;if (compare.strings(s1, s55)) {  IntVersion = VERSION_2439;  goto(found);}s1 = m8;if (compare.strings(s1, s55)) {  IntVersion = VERSION_2440;  goto(found);}[ s56=".xxx" means 2.903 through 2.917s1 = m9;if (compare.strings(s1, s56)) {  IntVersion = VERSION_2903;  goto(found);}s1 = m10;if (compare.strings(s1, s56)) {  IntVersion = VERSION_2911;  goto(found);}s1 = m11;if (compare.strings(s1, s56)) {  IntVersion = VERSION_2912;  goto(found);}s1 = m12;if (compare.strings(s1, s56)) {  IntVersion = VERSION_2915;  goto(found);}s1 = m13;if (compare.strings(s1, s56)) {  IntVersion = VERSION_2917;  goto(found);}[ s56="ersion 2.936" means 2.936s1 = m14;if (compare.strings(s1, s56)) {  IntVersion = VERSION_2936;  goto(found);}[ s56="ss ESC to quit." means 3.002.086s1 = m15;if (compare.strings(s1, s56)) {  IntVersion = VERSION_3002086;  goto(found);}[ s58="98", "2.102", "2.107" means 3.002.098 through 3.002.107s1 = m16;if (compare.strings(s1, s58)) {  IntVersion = VERSION_3002098;  goto(found);}s1 = m17;if (compare.strings(s1, s58)) {  IntVersion = VERSION_3002102;  goto(found);}s1 = m18;if (compare.strings(s1, s58)) {  IntVersion = VERSION_3002107;  goto(found);}[ s46="2.149" means 3.002.149s1 = m19;if (compare.strings(s1, s46)) {  IntVersion = VERSION_3002149;  goto(found);}[ not foundIntVersion = 0;:found[ verify this is a PC, with EGA monitorif (machineType != PC) {  print("This game will only run on a PC (or DOSBox), with EGA monitor.");  print("This is not a PC - \n  machine: %v20\n  monitor: %v26");  quit(1);} else {  if (monitorType != EGA) {    [ older versions don't identify monitor; they get checked when     [ patch is installed    if (IntVersion > VERSION_2272) {      print("This game will only run on a PC (or DOSBox), with EGA monitor.");      print("This is not an EGA monitor - \n  machine: %v20\n  monitor: %v26");      quit(1);    }  }}[ for demonstration, print the version (alternatively, you can[ do things like make sure your game gets run on a specific [ version, in case there are commands or features that your [ game uses that are version-dependent)v220 = IntVersion;v220 += 20;print.v(v220);return();[*****[ messages         [  declared messages go here[*****#message 1 " Durgan"          [2.089#message 2 "uit."             [2.272#message 3 "ersion 2.411"     [2.411#message 4 "ersion 2.425"     [2.425#message 5 "ersion 2.426"     [2.426#message 6 "ersion 2.435"     [2.435#message 7 "ersion 2.439"     [2.439#message 8 "ersion 2.440"     [2.440#message 9 ".903"             [2.903#message 10 ".911"            [2.911#message 11 ".912"            [2.912#message 12 ".915"            [2.915#message 13 ".917"            [2.917#message 14 "ersion 2.936"    [2.936#message 15 "ss ESC to quit." [3.002.086#message 16 "98"              [3.002.098#message 17 "2.102"           [3.002.102#message 18 "2.107"           [3.002.107#message 19 "2.149"           [3.002.149#message 20 "Version: unknown"#message 21 "Version: 2.089"#message 22 "Version: 2.272"#message 23 "Version: 2.411"#message 24 "Version: 2.425"#message 25 "Version: 2.426"#message 26 "Version: 2.435"#message 27 "Version: 2.439"#message 28 "Version: 2.440"#message 29 "Version: 2.903"#message 30 "Version: 2.911"#message 31 "Version: 2.912"#message 32 "Version: 2.915"#message 33 "Version: 2.917"#message 34 "Version: 2.936"#message 35 "Version: 3.002.086"#message 36 "Version: 3.002.098"#message 37 "Version: 3.002.102"#message 38 "Version: 3.002.107"#message 39 "Version: 3.002.149"